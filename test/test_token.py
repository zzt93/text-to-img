
text_list = ["数字5(19022) [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5]", "数字1(8891) [0.25, -0.25, -0.25, -0.25, 0.25, 0.25, -0.25, 0.25, 0.25, 0.25, 0.25, 0.25, -0.25, -0.25, 0.25, -0.25, 0.25, -0.25]"]
endoftext = 'endoftext'
all_text = ''
for text in text_list:
    text = text.strip()
    # 数字5(19022) [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5]
    all_text += text + endoftext
    start, end = text.index('('), text.index(')')
    all_text += ("The coordinates of the %s-th %s are %s" % (text[start + 1:end], text[0:start], text[end + 1 + 1:])) + endoftext


import minbpe.regex
import torch
from torch.nn.utils.rnn import pad_sequence

tokenizer = minbpe.regex.RegexTokenizer()
a=tokenizer.encode('数字0(54597) [-0.40625, -0.03125, -0.03125, 0.15625, -0.21875, 0.46875, 0.03125, 0.34375, -0.03125, -0.34375, -0.40625, -0.09375, 0.15625, 0.15625, -0.15625, -0.46875, 0.28125, 0.09375]')


sequences = [torch.tensor([230, 149, 176, 229, 173, 151, 53, 40, 49, 57, 48, 50, 50, 41, 32, 91, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 44, 32, 45, 48, 46, 53, 93]),torch.tensor([230, 149, 176, 229, 173, 151, 49, 40, 56, 56, 57, 49, 41, 32, 91, 48, 46, 50, 53, 44, 32, 45, 48, 46, 50, 53, 44, 32, 45, 48, 46, 50, 53, 44, 32, 45, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 45, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 45, 48, 46, 50, 53, 44, 32, 45, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 45, 48, 46, 50, 53, 44, 32, 48, 46, 50, 53, 44, 32, 45, 48, 46, 50, 53, 93])]
sequences = pad_sequence(sequences, batch_first=True, padding_value=-1)
mask = (sequences != -1).bool()